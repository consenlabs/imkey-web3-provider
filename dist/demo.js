"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.isHexPrefixed = isHexPrefixed;
exports.addHexPrefix = addHexPrefix;
exports.toBN = void 0;

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _index = _interopRequireDefault(require("./index"));

var _web = _interopRequireDefault(require("web3"));

var _ethereumjsAbi = _interopRequireDefault(require("ethereumjs-abi"));

var _bignumber = _interopRequireDefault(require("bignumber.js"));

var APPROVE_METHOD = "approve(address,uint256)";

var toBN = function toBN(x) {
  if (isNaN(Number(x))) return new _bignumber["default"](0);
  if (x instanceof _bignumber["default"]) return x;

  if (typeof x === "string") {
    if (x.indexOf("0x") === 0 || x.indexOf("-0x") === 0) {
      return new _bignumber["default"](x.replace("0x", ""), 16);
    }
  }

  return new _bignumber["default"](x);
};

exports.toBN = toBN;

function isHexPrefixed(str) {
  return str.slice(0, 2) === "0x";
}

function addHexPrefix(str) {
  if (typeof str !== "string") {
    return str;
  }

  return isHexPrefixed(str) ? str : "0x".concat(str);
}

var _getData = function _getData(spender) {
  var value = toBN(2).pow(256).minus(1).toString();

  var encoded = _ethereumjsAbi["default"].simpleEncode(APPROVE_METHOD, spender, value);

  var data = addHexPrefix(encoded.toString("hex"));
  return data;
};

var imkeyProvider = new _index["default"]({
  rpcUrl: "https://eth-mainnet.token.im",
  chainId: 1,
  headers: {
    agent: "ios:2.4.2:2"
  }
});
imkeyProvider.enable();
var web3 = new _web["default"](imkeyProvider); // allowanceTest();

imkeyProvider.on("disconnect", function (code, reason) {
  console.log("Ethereum Provider connection closed: ".concat(reason, ". Code: ").concat(code));
});
imkeyProvider.on("connect", function (connectInfo) {
  console.log("Ethereum Provider connected success, chainId: ".concat(connectInfo.chainId));
});
var btn = document.createElement("button");
btn.innerText = "requestAccounts";
btn.addEventListener("click", function (e) {
  function showResult(error, result) {
    if (error != null) {
      console.log("show error: ", error);
    } else {
      console.log("show result: ", result);
    }
  }

  web3.eth.requestAccounts(showResult).then(console.log);
});
var btnBalance = document.createElement("button");
btnBalance.innerText = "Get Balance";
btnBalance.addEventListener("click", function (e) {
  web3.eth.getBalance("0x8663b811c9601db1c5a93e41b894196400c14ed6").then(console.log);
});
var btnSignTransaction = document.createElement("button");
btnSignTransaction.innerText = "Sign Transaction";
btnSignTransaction.addEventListener("click", function (e) {
  function showResult(error, result) {
    if (error != null) {
      console.log("show error: ", error);
    } else {
      console.log("show result: ", result);
    }
  }

  web3.eth.signTransaction({
    from: "0x6031564e7b2F5cc33737807b2E58DaFF870B590b",
    // gasPrice: "20000000008",
    // nonce: 8,
    // gas: "21000",
    to: "0x3535353535353535353535353535353535353535",
    value: "100000000000000000" // chainId: 3,
    // data: "",

  }, showResult).then(console.log);
});
var btnSendTransaction = document.createElement("button");
btnSendTransaction.innerText = "Send Transaction";
btnSendTransaction.addEventListener("click", function (e) {
  function showResult(error, result) {
    if (error != null) {
      console.log("show error: ", error);
    } else {
      console.log("show result: ", result);
    }
  }

  web3.eth.sendTransaction({
    from: "0x6031564e7b2F5cc33737807b2E58DaFF870B590b",
    // gasPrice: "20000000008",
    // nonce: 8,
    // gas: "21000",
    to: "0x3535353535353535353535353535353535353535",
    value: "100000000000000000" // chainId: 3,
    // data: "",

  }).then(console.log);
});
var btnSignPersonalMessage = document.createElement("button");
btnSignPersonalMessage.innerText = "Sign Personal Message";
btnSignPersonalMessage.addEventListener("click", function (e) {
  function showResult(error, signature) {
    if (error != null) {
      console.log("show error: ", error);
    } else {
      console.log("show result: ", signature);
    }
  }

  web3.eth.personal.sign("Hello imKey", "0x6031564e7b2F5cc33737807b2E58DaFF870B590b", "", showResult).then(console.log) // @ts-ignore
  ["catch"](function (error) {
    console.log("error message: ", error.message);
  });
});
var btnSignMessage = document.createElement("button");
btnSignMessage.innerText = "Sign Message";
btnSignMessage.addEventListener("click", function (e) {
  function showResult(error, signature) {
    if (error != null) {
      console.log("show error: ", error);
    } else {
      console.log("show result: ", signature);
    }
  }

  web3.eth.sign("Hello imKey", "0x6031564e7b2F5cc33737807b2E58DaFF870B590b", showResult).then(console.log) // @ts-ignore
  ["catch"](function (error) {
    console.log("error message: ", error.message);
  });
});
var btnRequest_eth_requestAccounts = document.createElement("button");
btnRequest_eth_requestAccounts.innerText = "request eth_requestAccounts";
btnRequest_eth_requestAccounts.addEventListener("click", /*#__PURE__*/function () {
  var _ref = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee(e) {
    return _regenerator["default"].wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            // const accounts = ethereum.enable();
            // const accounts2 = ethereum.send('eth_requestAccounts')
            // .then((ret: any) => {
            //     console.log(ret);
            // })
            // .catch((error: any) => {
            //     console.log
            // });
            // const accounts3 = await ethereum.sendAsync({ method: 'eth_requestAccounts' });
            // console.log("accounts3: ",accounts3);
            // const accounts4 = await ethereum.request({ method: 'eth_requestAccounts' })
            // console.log("accounts4: ",accounts4);
            imkeyProvider.request({
              method: "eth_requestAccounts",
              params: []
            }).then(function (ret) {
              console.log(ret);
            })["catch"](function (error) {
              console.log;
            });

          case 1:
          case "end":
            return _context.stop();
        }
      }
    }, _callee);
  }));

  return function (_x) {
    return _ref.apply(this, arguments);
  };
}());
var btnRequest_eth_sign = document.createElement("button");
btnRequest_eth_sign.innerText = "request eth_sign";
btnRequest_eth_sign.addEventListener("click", /*#__PURE__*/function () {
  var _ref2 = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee2(e) {
    return _regenerator["default"].wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            imkeyProvider.request({
              method: "eth_sign",
              params: ["0x49206861766520313030e282ac", "0x6031564e7b2F5cc33737807b2E58DaFF870B590b"]
            }).then(function (ret) {
              console.log(ret);
            })["catch"](function (error) {
              console.log;
            });

          case 1:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2);
  }));

  return function (_x2) {
    return _ref2.apply(this, arguments);
  };
}());
var btnRequest_eth_signTransaction = document.createElement("button");
btnRequest_eth_signTransaction.innerText = "request eth_signTransaction";
btnRequest_eth_signTransaction.addEventListener("click", /*#__PURE__*/function () {
  var _ref3 = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee3(e) {
    return _regenerator["default"].wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            imkeyProvider.request({
              method: "eth_signTransaction",
              params: [{
                from: "0x6031564e7b2F5cc33737807b2E58DaFF870B590b",
                gasPrice: "0x4a817c808",
                nonce: 8,
                gas: "0x5208",
                to: "0x3535353535353535353535353535353535353535",
                value: "0x200",
                chainId: 3,
                data: ""
              }]
            }).then(function (ret) {
              console.log(ret);
            })["catch"](function (error) {
              console.log;
            });

          case 1:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3);
  }));

  return function (_x3) {
    return _ref3.apply(this, arguments);
  };
}()); // document.appendChild(btn);

document.body.append(btn);
document.body.append(btnBalance);
document.body.append(btnSignTransaction);
document.body.append(btnSignPersonalMessage);
document.body.append(btnSignMessage);
document.body.append(btnSendTransaction);
document.body.append(document.createElement("br"));
document.body.append(btnRequest_eth_requestAccounts);
document.body.append(btnRequest_eth_sign);
document.body.append(btnRequest_eth_signTransaction);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9kZW1vLnRzIl0sIm5hbWVzIjpbIkFQUFJPVkVfTUVUSE9EIiwidG9CTiIsIngiLCJpc05hTiIsIk51bWJlciIsIkJOIiwiaW5kZXhPZiIsInJlcGxhY2UiLCJpc0hleFByZWZpeGVkIiwic3RyIiwic2xpY2UiLCJhZGRIZXhQcmVmaXgiLCJfZ2V0RGF0YSIsInNwZW5kZXIiLCJ2YWx1ZSIsInBvdyIsIm1pbnVzIiwidG9TdHJpbmciLCJlbmNvZGVkIiwiYWJpIiwic2ltcGxlRW5jb2RlIiwiZGF0YSIsImlta2V5UHJvdmlkZXIiLCJJbUtleVByb3ZpZGVyIiwicnBjVXJsIiwiY2hhaW5JZCIsImhlYWRlcnMiLCJhZ2VudCIsImVuYWJsZSIsIndlYjMiLCJXZWIzIiwib24iLCJjb2RlIiwicmVhc29uIiwiY29uc29sZSIsImxvZyIsImNvbm5lY3RJbmZvIiwiYnRuIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJUZXh0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJzaG93UmVzdWx0IiwiZXJyb3IiLCJyZXN1bHQiLCJldGgiLCJyZXF1ZXN0QWNjb3VudHMiLCJ0aGVuIiwiYnRuQmFsYW5jZSIsImdldEJhbGFuY2UiLCJidG5TaWduVHJhbnNhY3Rpb24iLCJzaWduVHJhbnNhY3Rpb24iLCJmcm9tIiwidG8iLCJidG5TZW5kVHJhbnNhY3Rpb24iLCJzZW5kVHJhbnNhY3Rpb24iLCJidG5TaWduUGVyc29uYWxNZXNzYWdlIiwic2lnbmF0dXJlIiwicGVyc29uYWwiLCJzaWduIiwibWVzc2FnZSIsImJ0blNpZ25NZXNzYWdlIiwiYnRuUmVxdWVzdF9ldGhfcmVxdWVzdEFjY291bnRzIiwicmVxdWVzdCIsIm1ldGhvZCIsInBhcmFtcyIsInJldCIsImJ0blJlcXVlc3RfZXRoX3NpZ24iLCJidG5SZXF1ZXN0X2V0aF9zaWduVHJhbnNhY3Rpb24iLCJnYXNQcmljZSIsIm5vbmNlIiwiZ2FzIiwiYm9keSIsImFwcGVuZCJdLCJtYXBwaW5n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QUFFO0FBUlIsZUFETTtBQUZELGFBRFgsRUFnQkcyQixJQWhCSCxDQWdCUSxVQUFDbUIsR0FBRCxFQUFTO0FBQ2JqQyxjQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWWdDLEdBQVo7QUFDRCxhQWxCSCxXQW1CUyxVQUFDdkIsS0FBRCxFQUFXO0FBQ2hCVixjQUFBQSxPQUFPLENBQUNDLEdBQVI7QUFDRCxhQXJCSDs7QUFEdUQ7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsR0FBekQ7O0FBQUE7QUFBQTtBQUFBO0FBQUEsSyxDQXlCQTs7QUFDQUcsUUFBUSxDQUFDbUMsSUFBVCxDQUFjQyxNQUFkLENBQXFCckMsR0FBckI7QUFDQUMsUUFBUSxDQUFDbUMsSUFBVCxDQUFjQyxNQUFkLENBQXFCekIsVUFBckI7QUFDQVgsUUFBUSxDQUFDbUMsSUFBVCxDQUFjQyxNQUFkLENBQXFCdkIsa0JBQXJCO0FBQ0FiLFFBQVEsQ0FBQ21DLElBQVQsQ0FBY0MsTUFBZCxDQUFxQmpCLHNCQUFyQjtBQUNBbkIsUUFBUSxDQUFDbUMsSUFBVCxDQUFjQyxNQUFkLENBQXFCWixjQUFyQjtBQUNBeEIsUUFBUSxDQUFDbUMsSUFBVCxDQUFjQyxNQUFkLENBQXFCbkIsa0JBQXJCO0FBRUFqQixRQUFRLENBQUNtQyxJQUFULENBQWNDLE1BQWQsQ0FBcUJwQyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsSUFBdkIsQ0FBckI7QUFDQUQsUUFBUSxDQUFDbUMsSUFBVCxDQUFjQyxNQUFkLENBQXFCWCw4QkFBckI7QUFDQXpCLFFBQVEsQ0FBQ21DLElBQVQsQ0FBY0MsTUFBZCxDQUFxQk4sbUJBQXJCO0FBQ0E5QixRQUFRLENBQUNtQyxJQUFULENBQWNDLE1BQWQsQ0FBcUJMLDhCQUFyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJbUtleVByb3ZpZGVyIGZyb20gXCIuL2luZGV4XCI7XG5pbXBvcnQgV2ViMyBmcm9tIFwid2ViM1wiO1xuaW1wb3J0IHsgUkxQRW5jb2RlZFRyYW5zYWN0aW9uIH0gZnJvbSBcIndlYjMtZXRoXCI7XG5pbXBvcnQgYWJpIGZyb20gXCJldGhlcmV1bWpzLWFiaVwiO1xuaW1wb3J0IEJOIGZyb20gXCJiaWdudW1iZXIuanNcIjtcblxuY29uc3QgQVBQUk9WRV9NRVRIT0QgPSBcImFwcHJvdmUoYWRkcmVzcyx1aW50MjU2KVwiO1xuXG5leHBvcnQgY29uc3QgdG9CTiA9ICh4KTogQk4gPT4ge1xuICBpZiAoaXNOYU4oTnVtYmVyKHgpKSkgcmV0dXJuIG5ldyBCTigwKTtcbiAgaWYgKHggaW5zdGFuY2VvZiBCTikgcmV0dXJuIHg7XG5cbiAgaWYgKHR5cGVvZiB4ID09PSBcInN0cmluZ1wiKSB7XG4gICAgaWYgKHguaW5kZXhPZihcIjB4XCIpID09PSAwIHx8IHguaW5kZXhPZihcIi0weFwiKSA9PT0gMCkge1xuICAgICAgcmV0dXJuIG5ldyBCTih4LnJlcGxhY2UoXCIweFwiLCBcIlwiKSwgMTYpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbmV3IEJOKHgpO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzSGV4UHJlZml4ZWQoc3RyKSB7XG4gIHJldHVybiBzdHIuc2xpY2UoMCwgMikgPT09IFwiMHhcIjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZEhleFByZWZpeChzdHI6IHN0cmluZykge1xuICBpZiAodHlwZW9mIHN0ciAhPT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiBzdHI7XG4gIH1cbiAgcmV0dXJuIGlzSGV4UHJlZml4ZWQoc3RyKSA/IHN0ciA6IGAweCR7c3RyfWA7XG59XG5cbmludGVyZmFjZSBQcm92aWRlckNvbm5lY3RJbmZvIHtcbiAgcmVhZG9ubHkgY2hhaW5JZDogc3RyaW5nO1xufVxuXG5jb25zdCBfZ2V0RGF0YSA9IChzcGVuZGVyKSA9PiB7XG4gIGNvbnN0IHZhbHVlID0gdG9CTigyKS5wb3coMjU2KS5taW51cygxKS50b1N0cmluZygpO1xuICBjb25zdCBlbmNvZGVkID0gYWJpLnNpbXBsZUVuY29kZShBUFBST1ZFX01FVEhPRCwgc3BlbmRlciwgdmFsdWUpO1xuICBjb25zdCBkYXRhID0gYWRkSGV4UHJlZml4KGVuY29kZWQudG9TdHJpbmcoXCJoZXhcIikpO1xuICByZXR1cm4gZGF0YTtcbn07XG5cbmNvbnN0IGlta2V5UHJvdmlkZXIgPSBuZXcgSW1LZXlQcm92aWRlcih7XG4gIHJwY1VybDogXCJodHRwczovL2V0aC1tYWlubmV0LnRva2VuLmltXCIsXG4gIGNoYWluSWQ6IDEsXG4gIGhlYWRlcnM6IHtcbiAgICBhZ2VudDogXCJpb3M6Mi40LjI6MlwiLFxuICB9LFxufSk7XG5pbWtleVByb3ZpZGVyLmVuYWJsZSgpO1xuY29uc3Qgd2ViMyA9IG5ldyBXZWIzKGlta2V5UHJvdmlkZXIgYXMgYW55KTtcblxuLy8gYWxsb3dhbmNlVGVzdCgpO1xuaW1rZXlQcm92aWRlci5vbihcImRpc2Nvbm5lY3RcIiwgKGNvZGU6IGFueSwgcmVhc29uOiBhbnkpID0+IHtcbiAgY29uc29sZS5sb2coYEV0aGVyZXVtIFByb3ZpZGVyIGNvbm5lY3Rpb24gY2xvc2VkOiAke3JlYXNvbn0uIENvZGU6ICR7Y29kZX1gKTtcbn0pO1xuXG5pbWtleVByb3ZpZGVyLm9uKFwiY29ubmVjdFwiLCAoY29ubmVjdEluZm86IFByb3ZpZGVyQ29ubmVjdEluZm8pID0+IHtcbiAgY29uc29sZS5sb2coXG4gICAgYEV0aGVyZXVtIFByb3ZpZGVyIGNvbm5lY3RlZCBzdWNjZXNzLCBjaGFpbklkOiAke2Nvbm5lY3RJbmZvLmNoYWluSWR9YFxuICApO1xufSk7XG5cbmNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5idG4uaW5uZXJUZXh0ID0gXCJyZXF1ZXN0QWNjb3VudHNcIjtcbmJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgZnVuY3Rpb24gc2hvd1Jlc3VsdChlcnJvcjogRXJyb3IsIHJlc3VsdDogc3RyaW5nW10pIHtcbiAgICBpZiAoZXJyb3IgIT0gbnVsbCkge1xuICAgICAgY29uc29sZS5sb2coXCJzaG93IGVycm9yOiBcIiwgZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcInNob3cgcmVzdWx0OiBcIiwgcmVzdWx0KTtcbiAgICB9XG4gIH1cblxuICB3ZWIzLmV0aC5yZXF1ZXN0QWNjb3VudHMoc2hvd1Jlc3VsdCkudGhlbihjb25zb2xlLmxvZyk7XG59KTtcblxuY29uc3QgYnRuQmFsYW5jZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5idG5CYWxhbmNlLmlubmVyVGV4dCA9IFwiR2V0IEJhbGFuY2VcIjtcbmJ0bkJhbGFuY2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIHdlYjMuZXRoXG4gICAgLmdldEJhbGFuY2UoXCIweDg2NjNiODExYzk2MDFkYjFjNWE5M2U0MWI4OTQxOTY0MDBjMTRlZDZcIilcbiAgICAudGhlbihjb25zb2xlLmxvZyk7XG59KTtcblxuY29uc3QgYnRuU2lnblRyYW5zYWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbmJ0blNpZ25UcmFuc2FjdGlvbi5pbm5lclRleHQgPSBcIlNpZ24gVHJhbnNhY3Rpb25cIjtcbmJ0blNpZ25UcmFuc2FjdGlvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgZnVuY3Rpb24gc2hvd1Jlc3VsdChlcnJvcjogRXJyb3IsIHJlc3VsdDogUkxQRW5jb2RlZFRyYW5zYWN0aW9uKSB7XG4gICAgaWYgKGVycm9yICE9IG51bGwpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwic2hvdyBlcnJvcjogXCIsIGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coXCJzaG93IHJlc3VsdDogXCIsIHJlc3VsdCk7XG4gICAgfVxuICB9XG5cbiAgd2ViMy5ldGhcbiAgICAuc2lnblRyYW5zYWN0aW9uKFxuICAgICAge1xuICAgICAgICBmcm9tOiBcIjB4NjAzMTU2NGU3YjJGNWNjMzM3Mzc4MDdiMkU1OERhRkY4NzBCNTkwYlwiLFxuICAgICAgICAvLyBnYXNQcmljZTogXCIyMDAwMDAwMDAwOFwiLFxuICAgICAgICAvLyBub25jZTogOCxcbiAgICAgICAgLy8gZ2FzOiBcIjIxMDAwXCIsXG4gICAgICAgIHRvOiBcIjB4MzUzNTM1MzUzNTM1MzUzNTM1MzUzNTM1MzUzNTM1MzUzNTM1MzUzNVwiLFxuICAgICAgICB2YWx1ZTogXCIxMDAwMDAwMDAwMDAwMDAwMDBcIixcbiAgICAgICAgLy8gY2hhaW5JZDogMyxcbiAgICAgICAgLy8gZGF0YTogXCJcIixcbiAgICAgIH0sXG4gICAgICBzaG93UmVzdWx0XG4gICAgKVxuICAgIC50aGVuKGNvbnNvbGUubG9nKTtcbn0pO1xuXG5jb25zdCBidG5TZW5kVHJhbnNhY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuYnRuU2VuZFRyYW5zYWN0aW9uLmlubmVyVGV4dCA9IFwiU2VuZCBUcmFuc2FjdGlvblwiO1xuYnRuU2VuZFRyYW5zYWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBmdW5jdGlvbiBzaG93UmVzdWx0KGVycm9yOiBFcnJvciwgcmVzdWx0OiBSTFBFbmNvZGVkVHJhbnNhY3Rpb24pIHtcbiAgICBpZiAoZXJyb3IgIT0gbnVsbCkge1xuICAgICAgY29uc29sZS5sb2coXCJzaG93IGVycm9yOiBcIiwgZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcInNob3cgcmVzdWx0OiBcIiwgcmVzdWx0KTtcbiAgICB9XG4gIH1cblxuICB3ZWIzLmV0aFxuICAgIC5zZW5kVHJhbnNhY3Rpb24oe1xuICAgICAgZnJvbTogXCIweDYwMzE1NjRlN2IyRjVjYzMzNzM3ODA3YjJFNThEYUZGODcwQjU5MGJcIixcbiAgICAgIC8vIGdhc1ByaWNlOiBcIjIwMDAwMDAwMDA4XCIsXG4gICAgICAvLyBub25jZTogOCxcbiAgICAgIC8vIGdhczogXCIyMTAwMFwiLFxuICAgICAgdG86IFwiMHgzNTM1MzUzNTM1MzUzNTM1MzUzNTM1MzUzNTM1MzUzNTM1MzUzNTM1XCIsXG4gICAgICB2YWx1ZTogXCIxMDAwMDAwMDAwMDAwMDAwMDBcIixcbiAgICAgIC8vIGNoYWluSWQ6IDMsXG4gICAgICAvLyBkYXRhOiBcIlwiLFxuICAgIH0pXG4gICAgLnRoZW4oY29uc29sZS5sb2cpO1xufSk7XG5cbmNvbnN0IGJ0blNpZ25QZXJzb25hbE1lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuYnRuU2lnblBlcnNvbmFsTWVzc2FnZS5pbm5lclRleHQgPSBcIlNpZ24gUGVyc29uYWwgTWVzc2FnZVwiO1xuYnRuU2lnblBlcnNvbmFsTWVzc2FnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgZnVuY3Rpb24gc2hvd1Jlc3VsdChlcnJvcjogRXJyb3IsIHNpZ25hdHVyZTogc3RyaW5nKSB7XG4gICAgaWYgKGVycm9yICE9IG51bGwpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwic2hvdyBlcnJvcjogXCIsIGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coXCJzaG93IHJlc3VsdDogXCIsIHNpZ25hdHVyZSk7XG4gICAgfVxuICB9XG5cbiAgd2ViMy5ldGgucGVyc29uYWxcbiAgICAuc2lnbihcbiAgICAgIFwiSGVsbG8gaW1LZXlcIixcbiAgICAgIFwiMHg2MDMxNTY0ZTdiMkY1Y2MzMzczNzgwN2IyRTU4RGFGRjg3MEI1OTBiXCIsXG4gICAgICBcIlwiLFxuICAgICAgc2hvd1Jlc3VsdFxuICAgIClcbiAgICAudGhlbihjb25zb2xlLmxvZylcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJlcnJvciBtZXNzYWdlOiBcIiwgZXJyb3IubWVzc2FnZSk7XG4gICAgfSk7XG59KTtcblxuY29uc3QgYnRuU2lnbk1lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuYnRuU2lnbk1lc3NhZ2UuaW5uZXJUZXh0ID0gXCJTaWduIE1lc3NhZ2VcIjtcbmJ0blNpZ25NZXNzYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBmdW5jdGlvbiBzaG93UmVzdWx0KGVycm9yOiBFcnJvciwgc2lnbmF0dXJlOiBzdHJpbmcpIHtcbiAgICBpZiAoZXJyb3IgIT0gbnVsbCkge1xuICAgICAgY29uc29sZS5sb2coXCJzaG93IGVycm9yOiBcIiwgZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcInNob3cgcmVzdWx0OiBcIiwgc2lnbmF0dXJlKTtcbiAgICB9XG4gIH1cblxuICB3ZWIzLmV0aFxuICAgIC5zaWduKFxuICAgICAgXCJIZWxsbyBpbUtleVwiLFxuICAgICAgXCIweDYwMzE1NjRlN2IyRjVjYzMzNzM3ODA3YjJFNThEYUZGODcwQjU5MGJcIixcbiAgICAgIHNob3dSZXN1bHRcbiAgICApXG4gICAgLnRoZW4oY29uc29sZS5sb2cpXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3IgbWVzc2FnZTogXCIsIGVycm9yLm1lc3NhZ2UpO1xuICAgIH0pO1xufSk7XG5cbmNvbnN0IGJ0blJlcXVlc3RfZXRoX3JlcXVlc3RBY2NvdW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5idG5SZXF1ZXN0X2V0aF9yZXF1ZXN0QWNjb3VudHMuaW5uZXJUZXh0ID0gXCJyZXF1ZXN0IGV0aF9yZXF1ZXN0QWNjb3VudHNcIjtcbmJ0blJlcXVlc3RfZXRoX3JlcXVlc3RBY2NvdW50cy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKGUpID0+IHtcbiAgLy8gY29uc3QgYWNjb3VudHMgPSBldGhlcmV1bS5lbmFibGUoKTtcbiAgLy8gY29uc3QgYWNjb3VudHMyID0gZXRoZXJldW0uc2VuZCgnZXRoX3JlcXVlc3RBY2NvdW50cycpXG4gIC8vIC50aGVuKChyZXQ6IGFueSkgPT4ge1xuICAvLyAgICAgY29uc29sZS5sb2cocmV0KTtcbiAgLy8gfSlcbiAgLy8gLmNhdGNoKChlcnJvcjogYW55KSA9PiB7XG4gIC8vICAgICBjb25zb2xlLmxvZ1xuICAvLyB9KTtcbiAgLy8gY29uc3QgYWNjb3VudHMzID0gYXdhaXQgZXRoZXJldW0uc2VuZEFzeW5jKHsgbWV0aG9kOiAnZXRoX3JlcXVlc3RBY2NvdW50cycgfSk7XG4gIC8vIGNvbnNvbGUubG9nKFwiYWNjb3VudHMzOiBcIixhY2NvdW50czMpO1xuICAvLyBjb25zdCBhY2NvdW50czQgPSBhd2FpdCBldGhlcmV1bS5yZXF1ZXN0KHsgbWV0aG9kOiAnZXRoX3JlcXVlc3RBY2NvdW50cycgfSlcbiAgLy8gY29uc29sZS5sb2coXCJhY2NvdW50czQ6IFwiLGFjY291bnRzNCk7XG5cbiAgaW1rZXlQcm92aWRlclxuICAgIC5yZXF1ZXN0KHsgbWV0aG9kOiBcImV0aF9yZXF1ZXN0QWNjb3VudHNcIiwgcGFyYW1zOiBbXSB9KVxuICAgIC50aGVuKChyZXQpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJldCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZztcbiAgICB9KTtcbn0pO1xuXG5jb25zdCBidG5SZXF1ZXN0X2V0aF9zaWduID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbmJ0blJlcXVlc3RfZXRoX3NpZ24uaW5uZXJUZXh0ID0gXCJyZXF1ZXN0IGV0aF9zaWduXCI7XG5idG5SZXF1ZXN0X2V0aF9zaWduLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoZSkgPT4ge1xuICBpbWtleVByb3ZpZGVyXG4gICAgLnJlcXVlc3Qoe1xuICAgICAgbWV0aG9kOiBcImV0aF9zaWduXCIsXG4gICAgICBwYXJhbXM6IFtcbiAgICAgICAgXCIweDQ5MjA2ODYxNzY2NTIwMzEzMDMwZTI4MmFjXCIsXG4gICAgICAgIFwiMHg2MDMxNTY0ZTdiMkY1Y2MzMzczNzgwN2IyRTU4RGFGRjg3MEI1OTBiXCIsXG4gICAgICBdLFxuICAgIH0pXG4gICAgLnRoZW4oKHJldCkgPT4ge1xuICAgICAgY29uc29sZS5sb2cocmV0KTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nO1xuICAgIH0pO1xufSk7XG5cbmNvbnN0IGJ0blJlcXVlc3RfZXRoX3NpZ25UcmFuc2FjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5idG5SZXF1ZXN0X2V0aF9zaWduVHJhbnNhY3Rpb24uaW5uZXJUZXh0ID0gXCJyZXF1ZXN0IGV0aF9zaWduVHJhbnNhY3Rpb25cIjtcbmJ0blJlcXVlc3RfZXRoX3NpZ25UcmFuc2FjdGlvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKGUpID0+IHtcbiAgaW1rZXlQcm92aWRlclxuICAgIC5yZXF1ZXN0KHtcbiAgICAgIG1ldGhvZDogXCJldGhfc2lnblRyYW5zYWN0aW9uXCIsXG4gICAgICBwYXJhbXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGZyb206IFwiMHg2MDMxNTY0ZTdiMkY1Y2MzMzczNzgwN2IyRTU4RGFGRjg3MEI1OTBiXCIsXG4gICAgICAgICAgZ2FzUHJpY2U6IFwiMHg0YTgxN2M4MDhcIixcbiAgICAgICAgICBub25jZTogOCxcbiAgICAgICAgICBnYXM6IFwiMHg1MjA4XCIsXG4gICAgICAgICAgdG86IFwiMHgzNTM1MzUzNTM1MzUzNTM1MzUzNTM1MzUzNTM1MzUzNTM1MzUzNTM1XCIsXG4gICAgICAgICAgdmFsdWU6IFwiMHgyMDBcIixcbiAgICAgICAgICBjaGFpbklkOiAzLFxuICAgICAgICAgIGRhdGE6IFwiXCIsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pXG4gICAgLnRoZW4oKHJldCkgPT4ge1xuICAgICAgY29uc29sZS5sb2cocmV0KTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nO1xuICAgIH0pO1xufSk7XG5cbi8vIGRvY3VtZW50LmFwcGVuZENoaWxkKGJ0bik7XG5kb2N1bWVudC5ib2R5LmFwcGVuZChidG4pO1xuZG9jdW1lbnQuYm9keS5hcHBlbmQoYnRuQmFsYW5jZSk7XG5kb2N1bWVudC5ib2R5LmFwcGVuZChidG5TaWduVHJhbnNhY3Rpb24pO1xuZG9jdW1lbnQuYm9keS5hcHBlbmQoYnRuU2lnblBlcnNvbmFsTWVzc2FnZSk7XG5kb2N1bWVudC5ib2R5LmFwcGVuZChidG5TaWduTWVzc2FnZSk7XG5kb2N1bWVudC5ib2R5LmFwcGVuZChidG5TZW5kVHJhbnNhY3Rpb24pO1xuXG5kb2N1bWVudC5ib2R5LmFwcGVuZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIikpO1xuZG9jdW1lbnQuYm9keS5hcHBlbmQoYnRuUmVxdWVzdF9ldGhfcmVxdWVzdEFjY291bnRzKTtcbmRvY3VtZW50LmJvZHkuYXBwZW5kKGJ0blJlcXVlc3RfZXRoX3NpZ24pO1xuZG9jdW1lbnQuYm9keS5hcHBlbmQoYnRuUmVxdWVzdF9ldGhfc2lnblRyYW5zYWN0aW9uKTtcbiJdfQ==